{
  "prompts": [
    "**35_Implement_Week_Navigation**: UX/NAVEGACIÓN. **ÁMBITO: `src/features/EditorEntrenamiento`**. Es difícil navegar programas largos sin un índice.\n\n**Instrucciones:**\n1. Crea un componente `WeekNavigator.tsx` que se muestre como una barra lateral flotante o sticky a la izquierda del `EditorCanvas`.\n2. Este componente debe listar 'Semana 1', 'Semana 2', etc., como enlaces rápidos.\n3. Al hacer clic en una semana, el `EditorCanvas` debe hacer scroll suave hasta la posición de esa semana (usando `refs` o `react-window` métodos como `scrollToItem`).\n4. Resalta la semana actualmente visible en el viewport.\n\n**Referencias:**\n- Problema 3 en `@analisis_profundo_faltantes.md`.",
    "**36_Real_Data_FitCoach**: IA/LÓGICA. **ÁMBITO: `src/features/EditorEntrenamiento`**. El chat de FitCoach responde con textos predefinidos. Conéctalo a la lógica de validación real.\n\n**Instrucciones:**\n1. En `useFitCoach.ts`, modifica `processCommand`.\n2. En lugar de devolver texto estático, importa y llama a `validateProgram` de `logic/validationEngine.ts` pasando los datos actuales del programa.\n3. Si la validación devuelve alertas (ej: 'Volumen alto'), formatea esas alertas como mensajes del chat.\n4. Permite que el comando 'Analizar' ejecute este análisis en tiempo real y muestre los resultados.\n\n**Referencias:**\n- Problema 2.C en `@analisis_profundo_faltantes.md`.",
    "**37_DragDrop_Reorder_Weeks**: INTERACCIÓN. **ÁMBITO: `src/features/EditorEntrenamiento`**. Permite reordenar semanas completas.\n\n**Instrucciones:**\n1. Asegúrate de que el componente contenedor de cada semana en `EditorCanvas.tsx` sea un `SortableElement` de dnd-kit (si ya migraste a estructura de semanas).\n2. Añade un 'handle' de arrastre en el encabezado de la semana.\n3. Implementa la lógica `onDragEnd` en `EditorCanvas` para reordenar el array de `weeks` en el contexto cuando se suelta una semana en una nueva posición.\n\n**Referencias:**\n- Problema 3 en `@analisis_profundo_faltantes.md`.",
    "**38_Connect_Library_Creation**: FUNCIONALIDAD. **ÁMBITO: `src/features/EditorEntrenamiento`**. El botón '+ Crear Bloque' en la biblioteca no funciona.\n\n**Instrucciones:**\n1. En `LibraryPanel.tsx`, asegura que el botón abra un modal de creación (puede reutilizar uno existente o crear uno simple).\n2. Al guardar en el modal, crea un nuevo objeto `LibraryBlock`.\n3. Guárdalo en una lista de 'Bloques Personalizados' en `localStorage` o en el contexto (si decides mover la biblioteca al contexto).\n4. Actualiza la lista visual en `LibraryPanel` para mostrar este nuevo bloque en la sección 'Mis Bloques'.\n\n**Referencias:**\n- Problema 1 en `@analisis_profundo_faltantes.md`.",
    "**39_Implement_Client_Preview_Logic**: VISTA CLIENTE. **ÁMBITO: `src/features/EditorEntrenamiento`**. El modal de 'Vista Cliente' muestra datos reales pero no permite interacción de guardado.\n\n**Instrucciones:**\n1. En `ClientMobilePreview.tsx`, asegúrate de que 'Completar Set' (el check verde) actualice un estado local de 'progreso de sesión'.\n2. Añade un botón 'Finalizar Entrenamiento' funcional que, al hacer clic, genere un objeto de `feedback` (RPE sesión, duración real).\n3. Guarda este feedback en el objeto `Day` correspondiente en el contexto principal (simulando que el cliente completó el entreno).\n\n**Referencias:**\n- Problema 1 en `@analisis_profundo_faltantes.md` (mencionado como modal solo visual).",
    "**40_Fix_EmptyWeek_AI_Button**: ACCIÓN IA. **ÁMBITO: `src/features/EditorEntrenamiento`**. El botón 'Generar con IA' en semanas vacías muestra un alert.\n\n**Instrucciones:**\n1. En `EditorCanvas.tsx` (componente `EmptyWeekState`), reemplaza el `alert()` del botón 'Generar con IA'.\n2. Conéctalo para que abra el modal `AIProgramGenerator` (a través de `UIContext`).\n3. Asegúrate de pasarle el índice de la semana actual al generador, para que sepa dónde insertar el contenido generado.\n\n**Referencias:**\n- Problema 1 en `@analisis_profundo_faltantes.md`.",
    "**41_BatchTraining_MassAdjust_Logic**: LOGICA COMPLEJA. **ÁMBITO: `src/features/EditorEntrenamiento`**. Falta la lógica para 'Ajuste Masivo' en BatchTraining.\n\n**Instrucciones:**\n1. En `useBatchTraining.ts`, implementa `massAdjustment`.\n2. Esta función debe leer `config.increments` (o una nueva propiedad de configuración para ajustes absolutos).\n3. Debe permitir cambiar el RPE objetivo, la duración, o añadir/quitar Tags a **todos** los días/ejercicios en el rango de semanas seleccionado.\n4. Integra esta función en el flujo de `applyChanges`.\n\n**Referencias:**\n- Problema 2.A (Lógica simulada) en `@analisis_profundo_faltantes.md`.",
    "**42_BatchTraining_Template_Logic**: LOGICA COMPLEJA. **ÁMBITO: `src/features/EditorEntrenamiento`**. Falta la lógica para 'Aplicar Plantilla' en BatchTraining.\n\n**Instrucciones:**\n1. En `useBatchTraining.ts`, implementa `applyTemplate`.\n2. Debe permitir seleccionar una plantilla existente (necesitas inyectar `templates` en el hook).\n3. Debe sobrescribir los días del rango de semanas seleccionado con los días de la plantilla, repitiendo la plantilla si el rango es mayor que la duración de la plantilla.\n\n**Referencias:**\n- Problema 2.A en `@analisis_profundo_faltantes.md`.",
    "**43_Implement_Real_PDF_Generation**: EXPORTACIÓN. **ÁMBITO: `src/features/EditorEntrenamiento`**. La exportación a PDF es simulada.\n\n**Instrucciones:**\n1. Instala (si es necesario) o usa `jspdf` y `jspdf-autotable`.\n2. En `ExportModal.tsx` (o un nuevo servicio `utils/pdfGenerator.ts`), crea una función que tome `daysData` o `weeks` y genere un documento PDF real.\n3. El PDF debe incluir tabla de ejercicios, series, reps y logo del entrenador.\n4. Conecta el botón 'Descargar PDF' para que dispare esta generación y descargue el archivo.\n\n**Referencias:**\n- Problema 1 en `@analisis_profundo_faltantes.md`.",
    "**44_Implement_Real_Excel_Generation**: EXPORTACIÓN. **ÁMBITO: `src/features/EditorEntrenamiento`**. La exportación a Excel es simulada.\n\n**Instrucciones:**\n1. Usa la librería `xlsx` (ya en package.json).\n2. Crea un servicio `utils/excelGenerator.ts`.\n3. Implementa una función que transforme `daysData` en una hoja de cálculo plana (Semana, Día, Ejercicio, Series, Reps, RPE).\n4. Conecta el botón 'Descargar Excel' en `ExportModal.tsx` para generar el archivo `.xlsx` real.\n\n**Referencias:**\n- Problema 1 en `@analisis_profundo_faltantes.md`.",
    "**45_FitCoach_Action_Execution**: IA/AUTOMATIZACIÓN. **ÁMBITO: `src/features/EditorEntrenamiento`**. Las sugerencias de FitCoach tienen botones que solo hacen console.log.\n\n**Instrucciones:**\n1. En `useFitCoach.ts`, actualiza la estructura de `Alert` para incluir un `actionType` y `payload`.\n2. Crea un manejador centralizado `executeAction` que reciba el tipo de acción (ej: `ADJUST_VOLUME`, `FIX_RPE`).\n3. Conecta este manejador a `ProgramContext` para que realice las modificaciones reales en los datos (ej: iterar sobre ejercicios y bajar sets).\n\n**Referencias:**\n- Problema 2.C en `@analisis_profundo_faltantes.md`.",
    "**46_Implement_Global_Filtering**: UX/BÚSQUEDA. **ÁMBITO: `src/features/EditorEntrenamiento`**. La barra de filtros en `EditorCanvas` no filtra nada realmente.\n\n**Instrucciones:**\n1. En `EditorCanvas.tsx`, asegúrate de que el estado `searchTerm` y `activeFilters` se usen para filtrar la lista de `weeks` o `daysData` antes de pasarlos al renderizado (`WeekRow` o lista).\n2. Si un día no cumple los criterios de filtro, debe ocultarse o atenuarse visualmente (opacity 0.3).\n3. Asegura que el filtrado por Tags (#Fuerza) funcione correctamente leyendo los tags de cada día.\n\n**Referencias:**\n- Problema 3 (Navegación/Filtrado) en `@analisis_profundo_faltantes.md`.",
    "**47_Library_Save_Template_Logic**: PERSISTENCIA. **ÁMBITO: `src/features/EditorEntrenamiento`**. 'Guardar Plantilla' usa localStorage básico, hazlo más robusto.\n\n**Instrucciones:**\n1. En `useTemplateManager.ts`, mejora `saveAsTemplate`.\n2. Asegúrate de que valida que el nombre no exista.\n3. Implementa la lógica de 'sanitización' real (eliminar `weight` específico y dejar solo `reps/rpe`) antes de guardar.\n4. (Opcional) Si hay backend, prepara la llamada a API; si no, asegura persistencia robusta en localStorage con manejo de errores.\n\n**Referencias:**\n- Problema 4 (Integración de Datos) en `@analisis_profundo_faltantes.md`.",
    "**48_Tag_Refactoring_Propagation**: GESTIÓN DE DATOS. **ÁMBITO: `src/features/EditorEntrenamiento`**. Editar un Tag en `TagManager` debería actualizar todos los días que lo usan.\n\n**Instrucciones:**\n1. En `ProgramContext.tsx`, revisa `updateTag`.\n2. Asegúrate de que no solo actualice la lista `globalTags`, sino que itere sobre todo `daysData`.\n3. Encuentra cada instancia del tag (por ID) dentro de `days.tags` y `exercises.tags` y actualiza su `label` y `color`.\n4. Esto es crítico para mantener la consistencia visual.\n\n**Referencias:**\n- Problema 2 (Lógica de Negocio) en `@analisis_profundo_faltantes.md`.",
    "**49_Persistence_Layer_Upgrade**: BACKEND/DATOS. **ÁMBITO: `src/features/EditorEntrenamiento`**. `MockApiService` es demasiado volátil.\n\n**Instrucciones:**\n1. Crea un `LocalStorageAdapter` o mejora `MockApiService` para que guarde el estado completo del programa en `localStorage` bajo una key única por cliente.\n2. Al cargar la aplicación (`ProgramContext` mount), intenta recuperar estos datos antes de usar los datos iniciales (mock).\n3. Esto permitirá que el usuario refresque la página sin perder su trabajo (mientras no borre caché).\n\n**Referencias:**\n- Problema 4 (Persistencia Local Precaria) en `@analisis_profundo_faltantes.md`.",
    "**50_Timer_Result_Integration**: UTILIDAD. **ÁMBITO: `src/features/EditorEntrenamiento`**. El `TimerWidget` es aislado.\n\n**Instrucciones:**\n1. Modifica `TimerWidget.tsx` para aceptar un prop `onComplete(duration: number)`.\n2. En `TrainingBlock.tsx`, cuando se cierra el timer o termina, captura ese tiempo.\n3. Ofrece al usuario la opción de 'Guardar tiempo en bloque' que actualice la propiedad `duration` del bloque con el tiempo real registrado por el cronómetro.\n\n**Referencias:**\n- Problema 3 (UX/Herramientas aisladas) en `@analisis_profundo_faltantes.md`."
  ]
}
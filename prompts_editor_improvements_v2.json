{
  "prompts": [
    "**10_Canvas_Refactor_Architecture**: REFACTORIZACIÓN ESTRUCTURAL. **ÁMBITO: SOLO `src/features/EditorEntrenamiento`**. El componente `EditorCanvas.tsx` se ha vuelto monolítico. Antes de añadir funcionalidades complejas, necesito que desacoples los componentes internos en archivos individuales dentro de una nueva estructura de carpetas.\n\n**Instrucciones:**\n1. Crea el directorio `src/features/EditorEntrenamiento/components/canvas/`.\n2. Extrae el componente `ExerciseRowItem` y `SortableExerciseRow` a `src/features/EditorEntrenamiento/components/canvas/ExerciseRow.tsx`.\n3. Extrae `TrainingBlock` a `src/features/EditorEntrenamiento/components/canvas/TrainingBlock.tsx`.\n4. Extrae `DayCard` a `src/features/EditorEntrenamiento/components/canvas/DayCard.tsx`.\n5. Actualiza `EditorCanvas.tsx` para que solo gestione el estado global del DND y el layout del grid, importando estos nuevos componentes.\n\n**Referencias Visuales y de Diseño:**\n- Mantén la fidelidad visual actual basada en el código existente, preparando el terreno para la **Vista 1: SEMANAL** descrita en `@editor_entrenamiento_definitivo.md`.",
    "**11_BatchTraining_Wizard_UI**: NUEVA FUNCIONALIDAD (UI). **ÁMBITO: SOLO `src/features/EditorEntrenamiento`**. Implementa la interfaz del Wizard de BatchTraining, que actualmente falta según el análisis. No implementes la lógica compleja aún, solo la estructura del modal y los pasos.\n\n**Instrucciones:**\n1. Crea `src/features/EditorEntrenamiento/components/modals/BatchTraining/BatchTrainingModal.tsx`.\n2. Implementa un contenedor modal que muestre un 'Stepper' visual (Paso 1, 2, 3) en la parte superior.\n3. Crea subcomponentes para cada paso: `StepSelection.tsx`, `StepConfiguration.tsx`, `StepPreview.tsx`.\n4. En el paso 1, replica el diseño de tarjetas de selección (Duplicar Semana, Progresión Lineal, etc.) mostrado en el diseño ASCII.\n\n**Referencias Visuales y de Diseño:**\n- Revisa la sección **8. BATCHTRAINING - PASO 1** en `@diagramas_visuales_mejorados.md` para el layout exacto.\n- Revisa la sección 'BATCHTRAINING REDISEÑADO' en `@editor_entrenamiento_definitivo.md` para los textos y opciones.",
    "**12_BatchTraining_Logic_Hook**: NUEVA FUNCIONALIDAD (LÓGICA). **ÁMBITO: SOLO `src/features/EditorEntrenamiento`**. Implementa la lógica de estado para el Wizard de BatchTraining separada de la UI.\n\n**Instrucciones:**\n1. Crea el hook `src/features/EditorEntrenamiento/hooks/useBatchTraining.ts`.\n2. Gestiona el estado del paso actual (`currentStep`), la acción seleccionada (`selectedAction`) y la configuración del wizard.\n3. Implementa funciones vacías (placeholders) para `applyLinearProgression`, `duplicateWeek`, etc., que se conectarán más adelante.\n4. Conecta este hook al `BatchTrainingModal.tsx` creado anteriormente.\n\n**Referencias Visuales y de Diseño:**\n- Consulta la sección 'Paso 2: Configuración' en `@editor_entrenamiento_definitivo.md` para entender qué datos necesita manejar el estado (rango de semanas, incremento de carga, filtros).",
    "**13_Excel_View_Implementation**: VISTA CRÍTICA. **ÁMBITO: SOLO `src/features/EditorEntrenamiento`**. Implementa la 'Vista Excel' que actualmente es un placeholder, utilizando una tabla densa y editable.\n\n**Instrucciones:**\n1. Crea `src/features/EditorEntrenamiento/components/views/ExcelView.tsx`.\n2. Diseña una tabla HTML o CSS Grid que replique la estructura de columnas: Semana, Día, Sesión, Tags, Bloque, Ejercicio, Series, Reps, RPE, Notas.\n3. Implementa inputs transparentes para cada celda que permitan la edición 'inline'.\n4. Asegúrate de que las filas se puedan seleccionar (checkbox a la izquierda) para futuras acciones masivas.\n\n**Referencias Visuales y de Diseño:**\n- Es CRUCIAL seguir el diseño ASCII de la sección **4. VISTA EXCEL - COMPLETA** en `@diagramas_visuales_mejorados.md`.\n- Revisa la sección 'Vista 2: EXCEL' en `@editor_entrenamiento_definitivo.md` para el comportamiento de colapsado de jerarquía.",
    "**14_Timeline_View_Implementation**: NUEVA VISTA. **ÁMBITO: SOLO `src/features/EditorEntrenamiento`**. Implementa la 'Vista Timeline' para la visualización de mesociclos.\n\n**Instrucciones:**\n1. Crea `src/features/EditorEntrenamiento/components/views/TimelineView.tsx`.\n2. Implementa una visualización horizontal que muestre bloques de Mesociclos conteniendo Microciclos.\n3. Añade barras de progreso visuales para 'Volumen' e 'Intensidad' dentro de cada microciclo.\n4. Incluye el slider de Zoom en la parte superior (aunque sea visual por ahora).\n\n**Referencias Visuales y de Diseño:**\n- Revisa la sección **5. VISTA TIMELINE - MESOCICLOS** en `@diagramas_visuales_mejorados.md` para la composición visual de las barras de carga.",
    "**15_FitCoach_Logic_Separation**: REFACTORIZACIÓN Y MEJORA. **ÁMBITO: SOLO `src/features/EditorEntrenamiento`**. La lógica del chat en `FitCoachPanel.tsx` es básica y está mezclada con la UI. Extráela y poténciala.\n\n**Instrucciones:**\n1. Crea `src/features/EditorEntrenamiento/hooks/useFitCoach.ts`.\n2. Mueve el estado de `messages`, `alerts` y la función `handleSendMessage` a este hook.\n3. Implementa un parser de comandos simple en `handleSendMessage` que detecte palabras clave como 'optimiza', 'rodilla', 'tiempo' y devuelva respuestas predefinidas más ricas (simulando IA).\n4. Añade soporte para 'Action Cards' en el chat (mensajes que contienen botones de acción como 'Aplicar cambio').\n\n**Referencias Visuales y de Diseño:**\n- Revisa la sección **6. PANEL DERECHO - FITCOACH CHAT** en `@diagramas_visuales_mejorados.md` para ver cómo deben lucir las Action Cards y las Sugerencias Rápidas.",
    "**16_SmartFill_Integration**: INTEGRACIÓN DE LÓGICA. **ÁMBITO: SOLO `src/features/EditorEntrenamiento`**. Integra el solver `SmartFill` (existente en `src/features/editor-de-entreno/components/advanced/SmartFill.tsx`) en la UI del Editor.\n\n**Instrucciones:**\n1. Copia/adapta la lógica necesaria a `src/features/EditorEntrenamiento/utils/SmartFill.ts` (no modifiques la carpeta antigua, trae la lógica aquí).\n2. En `DayCard.tsx`, añade una opción en el menú contextual llamada '⚡ Smart Fill'.\n3. Crea un modal simple `SmartFillModal.tsx` que pida restricciones (Tiempo disponible, Material, Lesiones).\n4. Al confirmar, invoca la lógica de `SmartFillSolver` y actualiza los datos del día en el contexto global.\n\n**Referencias Visuales y de Diseño:**\n- Revisa la sección 'Smart Fill & Sustituciones' en `@editor_entrenamiento_definitivo.md` para entender el flujo de usuario deseado.",
    "**17_Interactive_Tags_System**: MEJORA DE UX. **ÁMBITO: SOLO `src/features/EditorEntrenamiento`**. Convierte los tags estáticos de los días en un sistema de gestión interactivo.\n\n**Instrucciones:**\n1. Crea el componente `src/features/EditorEntrenamiento/components/common/TagInput.tsx`.\n2. En `DayCard.tsx`, haz que el área de tags sea editable al hacer click.\n3. Implementa un dropdown de autocompletado que sugiera tags existentes (#Fuerza, #Hipertrofia) al escribir.\n4. Implementa la lógica para añadir y eliminar tags del estado del día.\n\n**Referencias Visuales y de Diseño:**\n- Revisa la sección **11. SISTEMA DE TAGS - FILTRADO ACTIVO** en `@diagramas_visuales_mejorados.md` y la sección 'SISTEMA DE TAGS PARA DÍAS' en `@editor_entrenamiento_definitivo.md`.",
    "**18_Library_Drag_Drop_Connect**: INTERACCIÓN CORE. **ÁMBITO: SOLO `src/features/EditorEntrenamiento`**. Conecta el Drag & Drop del `LibraryPanel` con el `EditorCanvas` para que sea funcional.\n\n**Instrucciones:**\n1. Crea o actualiza el hook `src/features/EditorEntrenamiento/hooks/useCanvasDnd.ts`.\n2. En el evento `onDragEnd`, detecta si el item soltado (`active.data.current`) proviene de la librería (`itemType: 'exercise' | 'block'`).\n3. Si el destino es un `DayCard` (droppable), transforma el dato de la librería a la estructura de `Exercise` o `Block` del canvas (generando nuevos IDs únicos) e insértalo en el estado.\n\n**Referencias Visuales y de Diseño:**\n- Revisa la sección '3. VISTA SEMANAL - DÍA EXPANDIDO' en `@diagramas_visuales_mejorados.md` para ver dónde deben aterrizar los elementos arrastrados.",
    "**19_Command_Palette_Implementation**: HERRAMIENTA PRO. **ÁMBITO: SOLO `src/features/EditorEntrenamiento`**. Implementa la paleta de comandos global (Cmd+K).\n\n**Instrucciones:**\n1. Crea `src/features/EditorEntrenamiento/components/overlays/CommandPalette.tsx`.\n2. Usa una librería como `cmdk` o implementa un modal con input de búsqueda y lista navegable con teclado.\n3. Define acciones: 'Crear nuevo día', 'Duplicar semana', 'Abrir BatchTraining', 'Cambiar a Vista Excel'.\n4. Registra el atajo de teclado global en `TopBar.tsx` o un hook global.\n\n**Referencias Visuales y de Diseño:**\n- Sigue estrictamente el diseño de la sección **13. PALETA DE COMANDOS** en `@diagramas_visuales_mejorados.md`.",
    "**20_Toast_Notification_System**: FEEDBACK DE USUARIO. **ÁMBITO: SOLO `src/features/EditorEntrenamiento`**. Implementa un sistema de notificaciones tipo 'Toast' para dar feedback de las acciones.\n\n**Instrucciones:**\n1. Crea `src/features/EditorEntrenamiento/components/feedback/ToastSystem.tsx`.\n2. Implementa variantes de notificaciones: Éxito (Verde), Advertencia (Naranja), Error (Rojo), Progreso (Azul).\n3. Crea un contexto `ToastContext` para poder disparar notificaciones desde cualquier parte del editor (ej: 'Guardado exitosamente', 'Error al duplicar').\n\n**Referencias Visuales y de Diseño:**\n- Revisa la sección **14. NOTIFICACIONES Y FEEDBACK** en `@diagramas_visuales_mejorados.md` para los estilos y posicionamiento."
  ]
}
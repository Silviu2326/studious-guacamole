{
  "prompts": [
    "**41_Collaboration_Core_Context**: ARQUITECTURA EN TIEMPO REAL. **MBITO: SOLO `src/features/EditorEntrenamiento`**. Implementa la infraestructura base para la colaboraci贸n multi-usuario.\n\n**Instrucciones:**\n1. Crea `src/features/EditorEntrenamiento/context/CollaborationContext.tsx`.\n2. Simula (o implementa con Socket.io/Firebase si es posible) una conexi贸n que reciba eventos: `USER_JOINED`, `USER_LEFT`, `BLOCK_UPDATED`.\n3. Gestiona un estado de `activeUsers` (lista de usuarios presentes en el documento).\n4. Muestra el indicador de 'Usuarios conectados' en la parte superior del panel central, como se ve en los diagramas.\n\n**Referencias Visuales y de Dise帽o:**\n- Revisa la secci贸n **3. MODO COLABORACIN EN TIEMPO REAL** en `@editor_entrenamiento_definitivo.md` para ver la UI de usuarios conectados.",
    "**42_Live_Cursors_Overlay**: FEEDBACK VISUAL. **MBITO: SOLO `src/features/EditorEntrenamiento`**. Implementa la visualizaci贸n de cursores o focos de otros usuarios en el editor.\n\n**Instrucciones:**\n1. Crea `src/features/EditorEntrenamiento/components/collaboration/CollaboratorCursors.tsx`.\n2. Cuando un usuario remoto selecciona un `TrainingBlock` o `ExerciseRow`, res谩ltalo visualmente con un borde de color espec铆fico para ese usuario (ej: Borde verde para Usuario B).\n3. Muestra una peque帽a etiqueta con el nombre del usuario ('Carlos est谩 editando...') flotando sobre el elemento bloqueado.\n\n**Referencias Visuales y de Dise帽o:**\n- Mira el indicador '锔 Carlos est谩 editando este ejercicio...' en la secci贸n **3. MODO COLABORACIN** de `@editor_entrenamiento_definitivo.md`.",
    "**43_Optimistic_Concurrency_Locking**: LGICA DE CONFLICTOS. **MBITO: SOLO `src/features/EditorEntrenamiento`**. Previene la sobreescritura de datos entre usuarios.\n\n**Instrucciones:**\n1. En `TrainingBlock.tsx` y `DayCard.tsx`, implementa la propiedad `isLockedBy`.\n2. Si un bloque est谩 siendo editado por otro usuario (seg煤n el contexto de colaboraci贸n), deshabilita todos los inputs y botones de ese bloque para el usuario local.\n3. A帽ade una superposici贸n visual (opacity + icono de candado) para indicar claramente que el bloque es de solo lectura temporalmente.\n\n**Referencias:**\n- Cumple con el principio de 'Confianza en la Interfaz' y prevenci贸n de errores descrito en `@editor_entrenamiento_definitivo.md`.",
    "**44_Contextual_Comments_System**: COMUNICACIN. **MBITO: SOLO `src/features/EditorEntrenamiento`**. Implementa un sistema de comentarios anclados a celdas o ejercicios espec铆ficos (estilo Google Sheets).\n\n**Instrucciones:**\n1. Crea `src/features/EditorEntrenamiento/components/collaboration/CommentThread.tsx`.\n2. Permite hacer click derecho en cualquier ejercicio -> 'A帽adir comentario'.\n3. Renderiza un peque帽o icono de burbuja de chat en el ejercicio que tiene comentarios.\n4. Al hacer click en la burbuja, abre un popover con el hilo de la conversaci贸n.\n\n**Referencias Visuales y de Dise帽o:**\n- Revisa la interacci贸n ' Mar铆a: \"Este peso es muy pesado...\"' en el diagrama de colaboraci贸n de `@editor_entrenamiento_definitivo.md`.",
    "**45_Offline_Sync_Queue**: RESILIENCIA DE DATOS. **MBITO: SOLO `src/features/EditorEntrenamiento`**. Asegura que el trabajo no se pierda si cae la conexi贸n.\n\n**Instrucciones:**\n1. Crea `src/features/EditorEntrenamiento/utils/offlineQueue.ts`.\n2. Implementa un interceptor o wrapper para las acciones de guardado (`saveDay`, `updateExercise`).\n3. Si no hay conexi贸n (`!navigator.onLine`), guarda la mutaci贸n en `localStorage` ('pending_changes').\n4. Escucha el evento `online` del navegador para procesar la cola y enviar los cambios al servidor secuencialmente.\n5. Muestra un indicador 'Sin conexi贸n - Guardando localmente' en la `TopBar`.\n\n**Referencias:**\n- Directamente relacionado con el KPI de '0 p茅rdidas de datos' en `@editor_entrenamiento_definitivo.md`.",
    "**46_Custom_Media_Upload**: GESTIN DE ASSETS. **MBITO: SOLO `src/features/EditorEntrenamiento`**. Permite a los entrenadores subir sus propios videos para ejercicios personalizados.\n\n**Instrucciones:**\n1. En `ExerciseDetailModal.tsx` (creado en prompts anteriores), a帽ade una pesta帽a 'Video Personalizado'.\n2. Implementa un 谩rea de Drag & Drop para archivos de video (`.mp4`, `.mov`).\n3. Muestra una barra de progreso de subida simulada.\n4. Una vez subido, reemplaza el video por defecto del ejercicio con el video del entrenador para este programa espec铆fico.\n\n**Referencias:**\n- Mencionado en las 'Integraciones 煤tiles (PT-first)' de `@editor_entrenamiento_definitivo.md`.",
    "**47_Actual_vs_Planned_Overlay**: VISUALIZACIN DE PROGRESO. **MBITO: SOLO `src/features/EditorEntrenamiento`**. Muestra lo que el cliente hizo realmente sobre lo que estaba planificado.\n\n**Instrucciones:**\n1. En `ExerciseRow.tsx`, a帽ade un modo de visualizaci贸n 'Revisi贸n'.\n2. Si existen datos reales (`actualReps`, `actualWeight` del cliente), mu茅stralos visualmente debajo o al lado de los valores planificados ('Target').\n3. Usa c贸digos de color: Verde si cumpli贸 el objetivo, Rojo si fall贸 por mucho, Gris si no hay datos.\n4. Permite al entrenador convertir los datos 'Reales' de esta semana en los 'Planificados' de la siguiente (Progreso autom谩tico).\n\n**Referencias Visuales y de Dise帽o:**\n- Revisa el concepto de 'Cohorte por cliente' y 'Progreso' en `@editor_entrenamiento_definitivo.md`.",
    "**48_Global_Undo_Redo_Manager**: HISTORIAL DE ESTADO. **MBITO: SOLO `src/features/EditorEntrenamiento`**. Implementa un gestor robusto de deshacer/rehacer que cubra todo el estado del editor.\n\n**Instrucciones:**\n1. Crea el hook `src/features/EditorEntrenamiento/hooks/useHistory.ts`.\n2. Implementa el patr贸n `Memento`: guarda snapshots del estado `programData` cada vez que ocurre una acci贸n destructiva (borrar, mover, cambio masivo).\n3. Exp贸n funciones `undo`, `redo`, `canUndo`, `canRedo`.\n4. Conecta los botones de la `TopBar` y los atajos de teclado (`Cmd+Z`) a este hook.\n\n**Referencias:**\n- Requisito expl铆cito en los '3 PRINCIPIOS FUNDAMENTALES' (Recuperaci贸n simple) de `@editor_entrenamiento_definitivo.md`.",
    "**49_Client_ReadOnly_Mode**: VISTA DEL CLIENTE. **MBITO: SOLO `src/features/EditorEntrenamiento`**. Implementa la vista simplificada que ver铆a el cliente en su m贸vil (simulaci贸n).\n\n**Instrucciones:**\n1. Crea `src/features/EditorEntrenamiento/components/preview/ClientMobilePreview.tsx`.\n2. Renderiza el programa actual pero en modo 'Solo Lectura' y con dise帽o 100% m贸vil (tipo app nativa).\n3. A帽ade botones grandes para 'Registrar serie' o 'Ver video', simulando la UX de la app del cliente.\n4. Permite al entrenador activar esta vista desde un bot贸n 'Previsualizar como Cliente' en la `TopBar`.\n\n**Referencias Visuales y de Dise帽o:**\n- Basado en la secci贸n **12. MODO RESPONSIVE - MOBILE** de `@diagramas_visuales_mejorados.md`, pero adaptado para consumo (logging) en lugar de edici贸n.",
    "**50_Feedback_Loop_Integration**: MEJORA CONTINUA. **MBITO: SOLO `src/features/EditorEntrenamiento`**. Integra el feedback post-sesi贸n del cliente en el editor.\n\n**Instrucciones:**\n1. En la `DayCard.tsx`, si el d铆a ya pas贸, muestra una secci贸n de 'Feedback del Cliente'.\n2. Visualiza m茅tricas subjetivas: RPE de sesi贸n (1-10), Dolor (S铆/No), Disfrute (1-5 estrellas).\n3. Muestra cualquier nota de texto dejada por el cliente ('Me doli贸 la rodilla en la sentadilla').\n4. A帽ade un bot贸n 'Ajustar siguiente semana' que abra el chat de FitCoach con contexto sobre este feedback.\n\n**Referencias:**\n- Revisa la secci贸n 'Quality Score de sesi贸n' en `@editor_entrenamiento_definitivo.md`."
  ]
}